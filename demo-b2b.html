<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <title>Portal B2B demo – AGC Web</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Portal demo B2B cu tabel de produse, prețuri pentru clienți business și coș de comandă." />
  <style>
    :root {
      --bg-main: #f4f4fb;
      --bg-header: #020617;
      --accent: #38bdf8;
      --accent-dark: #0ea5e9;
      --accent-soft: #e0f2fe;
      --text: #0f172a;
      --text-soft: #6b7280;
      --card-bg: #ffffff;
      --radius-lg: 14px;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--text);
      background: var(--bg-main);
    }
    a { text-decoration: none; color: inherit; }

    header {
      background: var(--bg-header);
      color: #e5e7eb;
      padding: 10px 18px;
    }
    .header-inner {
      max-width: 1120px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }
    .brand {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .brand-title {
      font-weight: 800;
      letter-spacing: 0.08em;
      font-size: 0.9rem;
      text-transform: uppercase;
    }
    .brand-sub {
      font-size: 0.75rem;
      color: #9ca3af;
    }
    .client-info {
      font-size: 0.8rem;
      text-align: right;
    }
    .client-info strong {
      display: block;
      font-size: 0.85rem;
      color: #e5e7eb;
    }

    main {
      max-width: 1120px;
      margin: 0 auto;
      padding: 20px 18px 40px;
    }
    h1 {
      font-size: 1.6rem;
      margin-bottom: 4px;
    }
    .lead {
      font-size: 0.9rem;
      color: var(--text-soft);
      margin-bottom: 16px;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.9fr) minmax(280px, 0.9fr);
      gap: 18px;
      align-items: flex-start;
    }

    .toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
      font-size: 0.85rem;
      align-items: center;
    }
    .toolbar label {
      margin-right: 4px;
    }
    .toolbar select,
    .toolbar input[type="text"] {
      padding: 5px 8px;
      border-radius: 999px;
      border: 1px solid #cbd5f5;
      font: inherit;
      font-size: 0.85rem;
      background: #f9fafb;
    }
    .toolbar input[type="checkbox"] {
      margin-right: 4px;
    }

    .table-wrap {
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      border: 1px solid #e5e7eb;
      box-shadow: 0 10px 26px rgba(15,23,42,0.06);
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }
    thead {
      background: #f1f5f9;
    }
    th, td {
      padding: 8px 10px;
      border-bottom: 1px solid #e5e7eb;
      text-align: left;
      white-space: nowrap;
    }
    th {
      font-weight: 600;
      color: #0f172a;
      font-size: 0.8rem;
    }
    tbody tr:last-child td {
      border-bottom: none;
    }
    tbody tr:nth-child(even) {
      background: #f9fafb;
    }
    .col-code { width: 80px; }
    .col-name { min-width: 160px; }
    .col-cat { width: 90px; }
    .col-stock { width: 90px; }
    .col-price { width: 90px; text-align: right; }
    .col-price-b2b { width: 100px; text-align: right; }
    .col-qty { width: 90px; text-align: center; }
    .col-add { width: 80px; text-align: center; }

    .stock-low {
      color: #b91c1c;
      font-weight: 600;
    }
    .stock-ok {
      color: #15803d;
    }

    .price-old {
      text-decoration: line-through;
      font-size: 0.75rem;
      color: #9ca3af;
      display: block;
    }
    .price-new {
      font-weight: 600;
    }

    .qty-input {
      width: 60px;
      padding: 3px 5px;
      border-radius: 999px;
      border: 1px solid #cbd5f5;
      font: inherit;
      font-size: 0.8rem;
      text-align: center;
    }

    .btn {
      border-radius: 999px;
      border: 1px solid #cbd5f5;
      background: #f9fafb;
      font-size: 0.8rem;
      padding: 6px 10px;
      cursor: pointer;
    }
    .btn-primary {
      background: var(--accent);
      border-color: var(--accent);
      color: #020617;
      font-weight: 600;
    }
    .btn-primary:hover {
      background: var(--accent-dark);
    }

    /* cart */
    .cart-panel {
      background: #0b1120;
      color: #e5e7eb;
      border-radius: var(--radius-lg);
      padding: 14px;
      border: 1px solid #1f2937;
      box-shadow: 0 10px 28px rgba(15,23,42,0.7);
      font-size: 0.9rem;
    }
    .cart-panel h2 {
      margin-top: 0;
      margin-bottom: 6px;
      font-size: 1.05rem;
      color: #e5e7eb;
    }
    .cart-items {
      list-style: none;
      padding: 0;
      margin: 6px 0 10px;
      max-height: 260px;
      overflow-y: auto;
    }
    .cart-items li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
      gap: 4px;
    }
    .cart-item-info {
      flex: 1;
      min-width: 0;
    }
    .cart-item-title {
      font-size: 0.85rem;
    }
    .cart-item-meta {
      font-size: 0.78rem;
      color: #9ca3af;
    }
    .cart-item-actions {
      font-size: 0.8rem;
    }
    .cart-empty {
      font-size: 0.85rem;
      color: #9ca3af;
      margin: 6px 0 10px;
    }
    .cart-total-line {
      display: flex;
      justify-content: space-between;
      font-size: 0.85rem;
      margin-bottom: 2px;
    }
    .cart-total-label {
      color: #9ca3af;
    }
    .cart-total-value {
      font-weight: 600;
    }
    .cart-note {
      font-size: 0.78rem;
      color: #9ca3af;
      margin-top: 6px;
    }
    .cart-actions-footer {
      display: flex;
      justify-content: space-between;
      gap: 6px;
      margin-top: 8px;
    }

    .back-link {
      font-size: 0.85rem;
      margin-top: 14px;
      display: inline-block;
      color: #0369a1;
    }

    @media (max-width: 900px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }
  </style>
</head>
<body>

<header>
  <div class="header-inner">
    <div class="brand">
      <div class="brand-title">AGC Web</div>
      <div class="brand-sub">Portal B2B demo (acces clienți)</div>
    </div>
    <div class="client-info">
      <strong>Client: SC Exemplu SRL</strong>
      Cod client: C-10245 · Listă de preț: B2B Standard
    </div>
  </div>
</header>

<main>
  <h1>Catalog produse – Portal B2B</h1>
  <p class="lead">
    Portal demo pentru clienți business: produsele sunt afișate într-un tabel, cu preț de listă și preț B2B negociat. Coșul este doar demonstrativ și nu trimite comenzi reale.
  </p>

  <div class="layout">
    <section>
      <div class="toolbar">
        <div>
          <label for="filterCategory">Categorie:</label>
          <select id="filterCategory">
            <option value="all">Toate</option>
            <option value="Fashion">Fashion</option>
            <option value="Cadouri">Cadouri</option>
            <option value="Office">Office</option>
            <option value="Vouchere">Vouchere</option>
          </select>
        </div>
        <div>
          <label for="filterText">Căutare produs:</label>
          <input type="text" id="filterText" placeholder="cod sau nume..." />
        </div>
        <div>
          <label><input type="checkbox" id="filterLowStock" /> Doar stoc limitat</label>
        </div>
      </div>

      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th class="col-code">Cod</th>
              <th class="col-name">Produs</th>
              <th class="col-cat">Categorie</th>
              <th class="col-stock">Stoc</th>
              <th class="col-price">Preț listă</th>
              <th class="col-price-b2b">Preț B2B</th>
              <th class="col-qty">Cant.</th>
              <th class="col-add">Adaugă</th>
            </tr>
          </thead>
          <tbody id="productTableBody">
            <!-- rândurile se generează din JS -->
          </tbody>
        </table>
      </div>
    </section>

    <aside>
      <div class="cart-panel">
        <h2>Coș B2B</h2>
        <ul class="cart-items" id="cartItems"></ul>
        <div id="cartEmpty" class="cart-empty">Coșul este gol. Adaugă produse pentru a construi o comandă demo.</div>
        <div class="cart-total-line">
          <span class="cart-total-label">Linii comandă:</span>
          <span class="cart-total-value" id="cartLines">0</span>
        </div>
        <div class="cart-total-line">
          <span class="cart-total-label">Cantitate totală:</span>
          <span class="cart-total-value" id="cartTotalQty">0</span>
        </div>
        <div class="cart-total-line">
          <span class="cart-total-label">Valoare netă (B2B):</span>
          <span class="cart-total-value" id="cartTotalPrice">0 RON</span>
        </div>
        <p class="cart-note">
          Într-un portal real, de aici se poate trimite direct o comandă fermă sau o cerere de ofertă, eventual cu termene de plată pe cont de client.
        </p>
        <div class="cart-actions-footer">
          <button class="btn" id="clearCartBtn">Golește coșul</button>
          <button class="btn btn-primary" id="checkoutBtn">Trimite la checkout demo</button>
        </div>
      </div>

      <a href="index.html" class="back-link">← Înapoi la site-ul principal</a>
    </aside>
  </div>
</main>

<script>
  const B2B_PRODUCTS = [
    // Cod, denumire, categorie, stoc, preț listă, reducere B2B (%)
    { code: "F-001", id: "p1",  name: "Tricou basic unisex",       category: "Fashion",  stock: 180, priceList: 79,  b2bDiscount: 0.15 },
    { code: "F-002", id: "p2",  name: "Hanorac cu glugă",          category: "Fashion",  stock: 40,  priceList: 159, b2bDiscount: 0.18 },
    { code: "F-003", id: "p3",  name: "Pantaloni casual",          category: "Fashion",  stock: 70,  priceList: 189, b2bDiscount: 0.2  },
    { code: "F-004", id: "p4",  name: "Geacă subțire de primăvară",category: "Fashion",  stock: 20,  priceList: 249, b2bDiscount: 0.18 },
    { code: "F-005", id: "p5",  name: "Șapcă logo",                category: "Fashion",  stock: 250, priceList: 59,  b2bDiscount: 0.1  },
    { code: "F-006", id: "p6",  name: "Pachet tricou + șapcă",     category: "Fashion",  stock: 50,  priceList: 129, b2bDiscount: 0.16 },

    { code: "C-101", id: "p7",  name: "Cană personalizată",        category: "Cadouri",  stock: 300, priceList: 49,  b2bDiscount: 0.18 },
    { code: "C-102", id: "p8",  name: "Set 2 căni cadou",          category: "Cadouri",  stock: 120, priceList: 95,  b2bDiscount: 0.17 },
    { code: "C-103", id: "p9",  name: "Cutie cadou premium",       category: "Cadouri",  stock: 35,  priceList: 129, b2bDiscount: 0.2  },
    { code: "C-104", id: "p10", name: "Felicitare personalizată",  category: "Cadouri",  stock: 500, priceList: 25,  b2bDiscount: 0.12 },

    { code: "O-201", id: "p11", name: "Agenda business",           category: "Office",   stock: 140, priceList: 89,  b2bDiscount: 0.15 },
    { code: "O-202", id: "p12", name: "Set pix + stilou",          category: "Office",   stock: 60,  priceList: 119, b2bDiscount: 0.2  },
    { code: "O-203", id: "p13", name: "Suport birou pentru telefon",category:"Office",   stock: 220, priceList: 39,  b2bDiscount: 0.1  },
    { code: "O-204", id: "p14", name: "Set organizare birou",      category: "Office",   stock: 45,  priceList: 149, b2bDiscount: 0.18 },

    { code: "V-301", id: "p15", name: "Voucher cadou 100 RON",     category: "Vouchere", stock: 999, priceList: 100, b2bDiscount: 0.05 },
    { code: "V-302", id: "p16", name: "Voucher cadou 200 RON",     category: "Vouchere", stock: 999, priceList: 200, b2bDiscount: 0.08 },
    { code: "V-303", id: "p17", name: "Voucher cadou 300 RON",     category: "Vouchere", stock: 999, priceList: 300, b2bDiscount: 0.1  },
    { code: "V-304", id: "p18", name: "Voucher cadou premium 500 RON",category:"Vouchere",stock: 999,priceList: 500,b2bDiscount: 0.12 }
  ];

  const CART_KEY_B2B = "agc_demo_cart_b2b_v1";
  let cart = {};

  function loadCart() {
    try {
      const raw = localStorage.getItem(CART_KEY_B2B);
      cart = raw ? JSON.parse(raw) || {} : {};
    } catch {
      cart = {};
    }
  }

  function saveCart() {
    localStorage.setItem(CART_KEY_B2B, JSON.stringify(cart));
  }

  function formatPrice(value) {
    return value.toLocaleString("ro-RO") + " RON";
  }

  function calcB2BPrice(p) {
    const discount = p.b2bDiscount || 0;
    const price = p.priceList * (1 - discount);
    return Math.round(price); // simplificăm pentru demo
  }

  function renderTable() {
    const tbody = document.getElementById("productTableBody");
    if (!tbody) return;
    tbody.innerHTML = "";

    const catFilter = document.getElementById("filterCategory").value;
    const textFilter = document.getElementById("filterText").value.trim().toLowerCase();
    const lowStockOnly = document.getElementById("filterLowStock").checked;

    let rows = B2B_PRODUCTS.filter(p => {
      if (catFilter !== "all" && p.category !== catFilter) return false;
      if (lowStockOnly && p.stock > 30) return false;
      if (textFilter) {
        const inText = (p.code + " " + p.name).toLowerCase().includes(textFilter);
        if (!inText) return false;
      }
      return true;
    });

    rows.forEach(p => {
      const tr = document.createElement("tr");
      const b2bPrice = calcB2BPrice(p);
      const stockClass = p.stock <= 30 ? "stock-low" : "stock-ok";
      const stockLabel = p.stock <= 30 ? "Stoc limitat" : "Disponibil";

      tr.innerHTML = `
        <td class="col-code">${p.code}</td>
        <td class="col-name">${p.name}</td>
        <td class="col-cat">${p.category}</td>
        <td class="col-stock"><span class="${stockClass}">${stockLabel}</span><br/><span style="font-size:0.75rem;color:#9ca3af;">${p.stock} buc.</span></td>
        <td class="col-price">
          <span class="price-old">${formatPrice(p.priceList)}</span>
        </td>
        <td class="col-price-b2b">
          <span class="price-new">${formatPrice(b2bPrice)}</span>
        </td>
        <td class="col-qty">
          <input type="number" min="1" value="1" class="qty-input" data-qty="${p.id}" />
        </td>
        <td class="col-add">
          <button class="btn btn-primary" data-add="${p.id}">+</button>
        </td>
      `;
      tbody.appendChild(tr);
    });

    tbody.onclick = function(e) {
      const addId = e.target.getAttribute("data-add");
      if (addId) {
        const qtyInput = tbody.querySelector(`input[data-qty="${addId}"]`);
        const qty = qtyInput ? parseInt(qtyInput.value, 10) || 1 : 1;
        addToCart(addId, qty);
      }
    };
  }

  function addToCart(productId, qty) {
    const product = B2B_PRODUCTS.find(p => p.id === productId);
    if (!product) return;
    const q = parseInt(qty, 10) || 1;
    const unitPrice = calcB2BPrice(product);
    if (!cart[productId]) {
      cart[productId] = {
        id: product.id,
        code: product.code,
        name: product.name,
        price: unitPrice,
        qty: 0
      };
    }
    cart[productId].qty += q;
    if (cart[productId].qty <= 0) {
      delete cart[productId];
    }
    saveCart();
    renderCart();
  }

  function clearCart() {
    cart = {};
    saveCart();
    renderCart();
  }

  function renderCart() {
    const listEl = document.getElementById("cartItems");
    const emptyEl = document.getElementById("cartEmpty");
    const linesEl = document.getElementById("cartLines");
    const totalQtyEl = document.getElementById("cartTotalQty");
    const totalPriceEl = document.getElementById("cartTotalPrice");

    if (!listEl) return;
    const entries = Object.values(cart);
    listEl.innerHTML = "";

    if (!entries.length) {
      emptyEl.style.display = "block";
    } else {
      emptyEl.style.display = "none";
    }

    let lines = 0;
    let totalQty = 0;
    let totalPrice = 0;

    entries.forEach(item => {
      lines += 1;
      totalQty += item.qty;
      totalPrice += item.qty * item.price;

      const li = document.createElement("li");
      li.innerHTML = `
        <div class="cart-item-info">
          <div class="cart-item-title">${item.code} · ${item.name}</div>
          <div class="cart-item-meta">${item.qty} x ${formatPrice(item.price)}</div>
        </div>
        <div class="cart-item-actions">
          <span>${formatPrice(item.qty * item.price)}</span>
        </div>
      `;
      listEl.appendChild(li);
    });

    linesEl.textContent = lines;
    totalQtyEl.textContent = totalQty;
    totalPriceEl.textContent = formatPrice(totalPrice);
  }

  // init
  loadCart();
  renderTable();
  renderCart();

  document.getElementById("filterCategory").addEventListener("change", renderTable);
  document.getElementById("filterText").addEventListener("input", renderTable);
  document.getElementById("filterLowStock").addEventListener("change", renderTable);

  document.getElementById("clearCartBtn").addEventListener("click", function() {
    if (confirm("Sigur vrei să golești coșul B2B demo?")) {
      clearCart();
    }
  });

  document.getElementById("checkoutBtn").addEventListener("click", function() {
    const hasItems = Object.keys(cart).length > 0;
    if (!hasItems) {
      alert("Coșul este gol. Adaugă produse înainte de a merge la checkout.");
      return;
    }
    window.location.href = "demo-b2b-checkout.html";
  });
</script>

</body>
</html>
